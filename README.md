# dftMP2bench

[//]: # "Badges"

[![GitHub Actions Build Status](https://github.com/REPLACE_WITH_OWNER_ACCOUNT/dftmp2bench/workflows/CI/badge.svg)](https://github.com/REPLACE_WITH_OWNER_ACCOUNT/dftmp2bench/actions?query=workflow%3ACI)
[![codecov](https://codecov.io/gh/REPLACE_WITH_OWNER_ACCOUNT/dftMP2bench/branch/main/graph/badge.svg)](https://codecov.io/gh/REPLACE_WITH_OWNER_ACCOUNT/dftMP2bench/branch/main)

Compare MP2 vs DFT energies

## Instructions

Using uv as a package manager, (pip install uv).

```bash
uv sync
source .venv/bin/activate
'''
Type "deactivate" to deactivate the environment.

Modify "directories.json" to point to the directories containing the output directories of the calculations you want to compare.
Include "user" as a way to identify who ran which calculations.

## Installing QM software

### XTB

XTB using xyz files as input: "xtb input.xyz"

### Orca
Orca is available on the clusters, try "module load orca", "which orca" to get the full path (orca needs to be run using the full path for jobs using multiple cores). "/full/path/to/orca input.com" will run the job.

### Psi4
Installation through conda:
```bash 
conda deactivate; conda create -n p4env psi4 -c conda-forge/label/libint_dev -c conda-forge
'''

"psi4 input.com"

### Gaussian16
Gaussian16 is available on the group cluster. Typically "gsub input.com" is enough.


## Literature

```latex
 @article{Goerigk_Hansen_Bauer_Ehrlich_Najibi_Grimme_2017, title={A look at the density functional theory zoo with the advanced GMTKN55 database for general main group thermochemistry, kinetics and noncovalent interactions}, volume={19}, ISSN={1463-9084}, url={https://pubs.rsc.org/en/content/articlelanding/2017/cp/c7cp04913g}, DOI={10.1039/C7CP04913G}, abstractNote={We present the GMTKN55 benchmark database for general main group thermochemistry, kinetics and noncovalent interactions. Compared to its popular predecessor GMTKN30 [Goerigk and Grimme J. Chem. Theory Comput., 2011, 7, 291], it allows assessment across a larger variety of chemical problems—with 13 new benchmark sets being presented for the first time—and it also provides reference values of significantly higher quality for most sets. GMTKN55 comprises 1505 relative energies based on 2462 single-point calculations and it is accessible to the user community via a dedicated website. Herein, we demonstrate the importance of better reference values, and we re-emphasise the need for London-dispersion corrections in density functional theory (DFT) treatments of thermochemical problems, including Minnesota methods. We assessed 217 variations of dispersion-corrected and -uncorrected density functional approximations, and carried out a detailed analysis of 83 of them to identify robust and reliable approaches. Double-hybrid functionals are the most reliable approaches for thermochemistry and noncovalent interactions, and they should be used whenever technically feasible. These are, in particular, DSD-BLYP-D3(BJ), DSD-PBEP86-D3(BJ), and B2GPPLYP-D3(BJ). The best hybrids are ωB97X-V, M052X-D3(0), and ωB97X-D3, but we also recommend PW6B95-D3(BJ) as the best conventional global hybrid. At the meta-generalised-gradient (meta-GGA) level, the SCAN-D3(BJ) method can be recommended. Other meta-GGAs are outperformed by the GGA functionals revPBE-D3(BJ), B97-D3(BJ), and OLYP-D3(BJ). We note that many popular methods, such as B3LYP, are not part of our recommendations. In fact, with our results we hope to inspire a change in the user community’s perception of common DFT methods. We also encourage method developers to use GMTKN55 for cross-validation studies of new methodologies.}, number={48}, journal={Physical Chemistry Chemical Physics}, publisher={The Royal Society of Chemistry}, author={Goerigk, Lars and Hansen, Andreas and Bauer, Christoph and Ehrlich, Stephan and Najibi, Asim and Grimme, Stefan}, year={2017}, month=dec, pages={32184–32215}, language={en} }
 @article{Goerigk_Mehta_2019, title={A Trip to the Density Functional Theory Zoo: Warnings and Recommendations for the User*}, volume={72}, ISSN={1445-0038}, url={https://www.publish.csiro.au/ch/CH19023}, DOI={10.1071/CH19023}, abstractNote={This account is written for general users of density functional theory (DFT) methods as well as experimental researchers who are new to the field and would like to conduct such calculations. Its main emphasis lies on how to find a way through the confusing ‘zoo’ of DFT by addressing common misconceptions and highlighting those modern methods that should ideally be used in calculations of energetic properties and geometries. A particular focus is on highly popular methods and the important fact that popularity does not imply accuracy. In this context, we present a new analysis of the openly available data published in Swart and co-workers’ famous annual ‘DFT poll’ (http://www.marcelswart.eu/dft-poll/) to demonstrate the existing communication gap between the DFT user and developer communities. We show that despite considerable methodological advances in the field, the perception of some parts of the user community regarding their favourite approaches has changed little. It is hoped that this account makes a contribution towards changing this status and that users are inspired to adjust their current computational protocols to accommodate strategies that are based on proven robustness, accuracy, and efficiency rather than popularity.}, number={8}, journal={Australian Journal of Chemistry}, publisher={CSIRO PUBLISHING}, author={Goerigk, Lars and Mehta, Nisha}, year={2019}, month=mar, pages={563–573}, language={en} }
 @article{Karton_2024, title={Big data benchmarking: how do DFT methods across the rungs of Jacob’s ladder perform for a dataset of 122k CCSD(T) total atomization energies?}, volume={26}, ISSN={1463-9084}, url={https://pubs.rsc.org/en/content/articlelanding/2024/cp/d4cp00387j}, DOI={10.1039/D4CP00387J}, abstractNote={Total atomization energies (TAEs) are a central quantity in density functional theory (DFT) benchmark studies. However, so far TAE databases obtained from experiment or high-level ab initio wavefunction theory included up to hundreds of TAEs. Here, we use the GDB-9 database of 133k CCSD(T) TAEs generated by Curtiss and co-workers [B. Narayanan, P. C. Redfern, R. S. Assary and L. A. Curtiss, Chem. Sci., 2019, 10, 7449] to evaluate the performance of 14 representative DFT methods across the rungs of Jacob’s ladder (namely, PBE, BLYP, B97-D, M06-L, τ-HCTH, PBE0, B3LYP, B3PW91, ωB97X-D, τ-HCTHh, PW6B95, M06, M06-2X, and MN15). We first use the A25[PBE] diagnostic for nondynamical correlation to eliminate systems that potentially include significant multireference effects, for which the CCSD(T) TAEs might not be sufficiently reliable. The resulting database (denoted by GDB9-nonMR) includes 122k species. Of the considered functionals, B3LYP attains the best performance relative to the G4(MP2) reference TAEs, with a mean absolute deviation (MAD) of 4.09 kcal mol−1. This first-generation hybrid functional, in which the three mixing coefficients were fitted against a small set of TAEs, is one of the few functionals that are not systematically biased towards overestimating the G4(MP2) TAEs, as demonstrated by a mean-signed deviation (MSD) of 0.45 kcal mol−1. The relatively good performance of B3LYP is followed by the heavily parameterized M06-L meta-GGA functional, which attains a MAD of 6.24 kcal mol−1. The PW6B95, M06, M06-2X, and MN15 functionals tend to systematically overestimate the G4(MP2) TAEs and attain MADs ranging between 18.69 (M06) and 28.54 (MN15) kcal mol−1. However, PW6B95 and M06-2X exhibit particularly narrow error distributions. Thus, scaling their TAEs by an empirical scaling factor reduces their MADs to merely 3.38 (PW6B95) and 2.85 (M06-2X) kcal mol−1. Empirical dispersion corrections (e.g., D3 and D4) are attractive, and therefore, their inclusion worsens the performance of methods that systematically overestimate the TAEs.}, number={20}, journal={Physical Chemistry Chemical Physics}, publisher={The Royal Society of Chemistry}, author={Karton, Amir}, year={2024}, month=may, pages={14594–14606}, language={en} }
 @article{Karton_de Oliveira_2025, title={Good Practices in Database Generation for Benchmarking Density Functional Theory}, volume={15}, rights={© 2025 Wiley Periodicals LLC.}, ISSN={1759-0884}, url={https://onlinelibrary.wiley.com/doi/abs/10.1002/wcms.1737}, DOI={10.1002/wcms.1737}, abstractNote={The hundreds of density functional theory (DFT) methods developed over the past three decades are often referred to as the “zoo” of DFT approximations. In line with this terminology, the numerous DFT benchmark studies might be considered the “safari” of DFT evaluation efforts, reflecting their abundance, diversity, and wide range of application and methodological aspects. These benchmarks have played a critical role in establishing DFT as the dominant approach in quantum chemical applications and remain essential for selecting an appropriate DFT method for specific chemical properties (e.g., reaction energy, barrier height, or noncovalent interaction energy) and systems (e.g., organic, inorganic, or organometallic). DFT benchmark studies are a vital tool for both DFT users in method selection and DFT developers in method design and parameterization. This review provides best-practice guidance on key methodological aspects of DFT benchmarking, such as the quality of benchmark reference values, dataset size, reference geometries, basis sets, statistical analysis, and electronic availability of the benchmark data. Additionally, we present a flowchart to assist users in systematically choosing these methodological aspects, thereby enhancing the reliability and reproducibility of DFT benchmarking studies.}, number={1}, journal={WIREs Computational Molecular Science}, author={Karton, Amir and de Oliveira, Marcelo T.}, year={2025}, pages={e1737}, language={en} }
 @article{Lutz_Byrd_Montgomery Jr._2021, title={Benchmark comparison of dual-basis double-hybrid density functional theory and a neural-network-optimized method for intermolecular interactions}, volume={376}, ISSN={0022-2852}, url={https://www.sciencedirect.com/science/article/pii/S0022285220301740}, DOI={10.1016/j.jms.2020.111406}, abstractNote={We present a computationally efficient implementation of double-hybrid density functional theory (DH-DFT) leveraging the dual basis methods of Head-Gordon and co-workers and the resolution-of-the-identity second-order Møller-Plesset (RI-MP2) theory. The B2PLYP, B2GP-PLYP, DSD-BLYP and DSD-PBEP86 density functionals are applied to assess the performance of dual-basis methods on several benchmark test cases, including the CONF set of conformational energy differences in C4-C7 alkanes, the S22 set of noncovalent interaction energies, and the RGC10 noble-gas dimer dissociation curves. The dual-basis DH-DFT approach is shown to give results in excellent agreement with conventional methods at a reduced computational cost. For noncovalent interaction energies, DH-DFT is compared against a leading neural-network-based approach, namely the SNS-MP2 method of McGibbon and coworkers (McGibbon et al., 2017). The DH-DFT and SNS-MP2 methods are shown to produce similar accuracies when compared to the established benchmark values.}, journal={Journal of Molecular Spectroscopy}, author={Lutz, Jesse J. and Byrd, Jason N. and Montgomery Jr., John A.}, year={2021}, month=feb, pages={111406} }
 @article{Matczak_Wojtulewski_2015, title={Performance of Møller-Plesset second-order perturbation theory and density functional theory in predicting the interaction between stannylenes and aromatic molecules}, volume={21}, ISSN={1610-2940}, url={https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4326664/}, DOI={10.1007/s00894-015-2589-1}, abstractNote={The performances of Møller-Plesset second-order perturbation theory (MP2) and density functional theory (DFT) have been assessed for the purposes of investigating the interaction between stannylenes and aromatic molecules. The complexes between SnX2 (where X = H, F, Cl, Br, and I) and benzene or pyridine are considered. Structural and energetic properties of such complexes are calculated using six MP2-type and 14 DFT methods. The assessment of the above-mentioned methods is based on the comparison of the structures and interaction energies predicted by these methods with reference computational data. A very detailed analysis of the performances of the MP2-type and DFT methods is carried out for two complexes, namely SnH2-benzene and SnH2-pyridine. Of the MP2-type methods, the reference structure of SnH2-benzene is reproduced best by SOS-MP2, whereas SCS-MP2 is capable of mimicking the reference structure of SnH2-pyridine with the greatest accuracy. The latter method performs best in predicting the interaction energy between SnH2 and benzene or pyridine. Among the DFT methods, ωB97X provides the structures and interaction energies of the SnH2-benzene and SnH2-pyridine complexes with good accuracy. However, this density functional is not as effective in reproducing the reference data for the two complexes as the best performing MP2-type methods. Next, the DFT methods are evaluated using the full test set of SnX2-benzene and SnX2-pyridine complexes. It is found that the range-separated hybrid or dispersion-corrected density functionals should be used for describing the interaction in such complexes with reasonable accuracy.}, number={3}, journal={Journal of Molecular Modeling}, author={Matczak, Piotr and Wojtulewski, Sławomir}, year={2015}, pages={41} }
 @article{Wappett_Goerigk, title={Benchmarking Density Functional Theory Methods for Metalloenzyme Reactions: The Introduction of the MME55 Set}, author={Wappett, Dominique A and Goerigk, Lars}, language={en} }
```

### Copyright

Copyright (c) 2025, Eric Boittier

#### Acknowledgements

Project based on the
[Computational Molecular Science Python Cookiecutter](https://github.com/molssi/cookiecutter-cms) version 1.10.
